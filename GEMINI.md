# 本プロジェクトの目的

- Macのショートカットappから呼び出されるスクリプト群です。
- ファイルごとに目的が異なります。

## ファイル構成と役割

### `add_audio_info_to_notion.py`

- **目的**: m4aファイルのメタデータを読み取り、Notionデータベースに登録します。
- **処理の流れ**:
    1. コマンドライン引数としてm4aファイルのパスを受け取ります。
    2. ffmpegを使い、ファイルからメタデータ（トラックNo, タイトル, アーティスト, アルバム）を抽出します。
    3. .envファイルからNotion API情報を読み込みます。
    4. 抽出したメタデータをNotionデータベースの対応するカラム（トラックNo, タイトル, アーティスト, アルバム, ファイル）に登録します。
- **TASK**:
  - □ 基本的な処理の骨格を作成する。

### `download_audio_from_html.py`

- **目的**: HTMLから音声ファイルをDLし、タグやカバー画像を埋め込んで保存します。
- **処理の流れ**:
    1. HTMLファイルが入力として渡されます。
    2. 渡されたドメインによってHTMLの処理方法が分岐します。（特定のドメイン向けの関数を作成）
    3. 関数の中で、metadataのタイトル（エピソード名）、パーソナリティ名、アルバム名（番組名）を取得します。
    4. 関数の中で音声ファイルとカバー画像をダウンロードします。
    5. ffmpegを用いて音声ファイルにmetadataを付ಯします。
    6. ffmpegを用いて音声ファイルにカバー画像を埋め込みます。
- **ポイント**:
  - ドメインごとの関数を作成することで、対象ドメインが増えても関数を増やすだけで対応できるようにします。

### `archive/download_audee.py` (アーカイブ)

- 特定のURLをヘッドレスモードで開き、URLからHTMLを取得して特定のファイルをダウンロードします。
- **TASK**:
  - ✅ 保存するディレクトリを指定できるようにする。（Macのショートカットappから引数で指定する予定）
  - ✅ ファイル名を「{番組名}_{エピソード名}」のようにわかりやすいものにする。
  - ✅ ffmpegを用いて、音声ファイルのmetadataにタイトル（エピソード名）、パーソナリティ名、アルバム名（番組名）を付与する。
  - ✅ ffmpegを用いて、音声ファイルのフロントカバーにカバー画像を埋め込む。

### `archive/download_bitfan.py` (アーカイブ)

- 特定のURLをヘッドレスモードで開き、URLからHTMLを取得して特定のファイルをダウンロードします。
- **TASK**:
  - ✅ 保存するディレクトリを指定できるようにする。（Macのショートカットappから引数で指定する予定）
  - ✅ ファイル名を「{番組名}_{エピソード名}」のようにわかりやすいものにする。
  - ✅ ffmpegを用いて、音声ファイルのmetadataにタイトル（エピソード名）、パーソナリティ名、アルバム名（番組名）を付与する。
  - ✅ ffmpegを用いて、音声ファイルのフロントカバーにカバー画像を埋め込む。

## コーディング規約

- ソースは意味のあるブロック単位で「何をしているブロックなのか」がわかるように日本語でコメントを入れる。
- 依頼した作業が完了したら修正したファイル群を適切なメッセージでcommitすること。  
  - 複数行のcommitはヒアドキュメントを利用する。
  - コミット内容はオーナーがレビューする。
- t-wadaのテスト思考を取り入れたい。
- ffmpeg(ffprobe)に関する操作は`MyFfmpegHelper`モジュールに実装し、それを利用すること。
- Notion APIに関する操作は`MyNotionHelper`モジュールに実装し、それを利用すること。

## GEMINIとのやりとり仕様

- 日本語で会話すること。
- TASKで完成したものは先頭に✅をつける。